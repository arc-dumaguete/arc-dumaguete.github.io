# Arc Dumaguete site

The site is made using [Jekyll](https://jekyllrb.com/docs/), which allows us to author the site using Markdown syntax, which gets compiled into HTML.

## Setting up the repositories locally

You should clone the repository and check out the jekyll branch with:
```
git clone git@github.com:arc-dumaguete/arc-dumaguete.github.io.git
git checkout jekyll
```
The jekyll branch jis the default branch and is where you should edit/add your posts. From there, the compiled HTML for the website is automatically generated by Travis-CI as soon as you commit and push. So no need to do that manually. You can even add/edit pages directly on github.com without checking the code out locally.

*The steps below are no longer needed since the Travis automation*

We have it setup so that the master branch contains the compiled html version, while the jekyll branch contains the jekyll source.
Then you can author in the jekyll branch, compile, and push the resulting site to the master branch. The easiest way to get this to work is to `git clone git@github.com:arc-dumaguete/arc-dumaguete.github.io.git` clone the repository, then `git checkout jekyll`. Then again, but now in side the existing clone of the jekyll branch, `git clone git@github.com:arc-dumaguete/arc-dumaguete.github.io.git ./_site`. This will clone the master branch in the `_site` directory. This directory is where jekyll will put the compiled HTML version, and that folder is ignored in `.gitignore` so won't be included in the jekyll branch. 


## Editing
The easiest way to change the site is just on [github](https://github.com/arc-dumaguete/arc-dumaguete.github.io). All posts are in the `_posts` folder. You can edit those directly there. If you want to make a new post, make a new post by copying an existing file. Then edit that new file.

At the top of each file is a section called the [Front Matter](https://jekyllrb.com/docs/front-matter/). This section contains some configuration for that page like the title, author, date, etc. These you can edit. Make sure to look at existing pages and if you don't know what a variable in the Front Matter means, just copy it from another post. 

If you want, you can also checkout the jekyll branch and edit on your local pc, and build and serve the site locally. But this is not necessary.

### New authors
When someone makes their first page, you can set them as author of the post, but they also need to be added to the `_data/authors.yml` file.

### New tags
If you add a tag that didn't exist before, make sure to also add that to the `_data/tags.yml` file. 

## Installing dependencies
You only need to do this if you want to locally serve the site for testing, or if you want to manually build the site. If you just want to add/edit a post, just make/edit the file in the jekyll branch and commit and push. Travis-CI takes care of the rest.

Make sure you have ruby, ruby-dev (or ruby-devel in redhat/centos/fedora) and rubygem-bundler installed.
Install npm/nodejs and gulp, probably easiest through the package manager or your OS.
Run
```
bundler install
npm install
```

## Building/compiling the site
There is no need to manually compile and push the website. The process is automated using travis-ci. So as soon as you commit and push to the jekyll branch, travis-ci will take care of building the site and pushing to the master branch.

If you still want to manually build the site, this is how to do it:
Run
```
bundler exec jekyll build
```
then to publish
```
cd _site
git add *
git commit -a
git push
```

## Serving locally for testing
```
bundler exec jekyll serve
```

## Hiding and showing pages
If you want to hide a page, you can set `published: False` in the front matter for that page. That way it will not show up on the site. If you still want to see that page locally for testing purposes, you can start your local version with `bundler exec jekyll serve --unpublished`

See also https://sangsoonam.github.io/2018/12/27/writing-upcoming-posts-in-github-pages.html

## Compiling styles
The styles are in assets/css. If you modify them, you need to compile them with `gulp`.
